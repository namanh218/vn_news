import requestsfrom bs4 import BeautifulSoupfrom pymongo import MongoClientimport timefrom multiprocessing import Process# connect to atlas mongodbtry:    client = MongoClient("mongodb+srv://m001-student:namanh123@sandbox-fwkp4.mongodb.net/test?retryWrites=true&w=majority")    print('Connected')except Exception as err:    print(err)db = client.productcollection = db.all_product# print all available dbprint(client.list_database_names())BASE_URL = 'https://www.thuocbietduoc.com.vn/defaults/drgsearch?start=1'# Get the linkdef parse_url(url):    try:        while True:            response = requests.get(url)            if response:                soup = BeautifulSoup(response.text, 'html.parser')                return soup            time.sleep(5)    except Exception as err:        print(err)        return ''# Get all the content and titlesdef parse_url(url):    try:        while True:            response = requests.get(url)            if response:                soup = BeautifulSoup(response.text, 'html.parser')                return soup            time.sleep(5)    except Exception as err:        print(err)        return ''def get_content(url):    s = parse_url(url)    d = s.find_all('a', class_="textlink01_v")    n = s.find_all('td', class_="textdrg_hoz")    names = [d[i].string.strip() for i in range(0, len(d), 2)]    images = [i.get('src') for i in s.find_all('img', class_="imgdrg_lst")]    info = [i.div.string for i in n if i.div != None]    nhom = [' '.join(dict.fromkeys(n[i].string.split())) for i in range(0, len(n), 2) if n[i].string != None]    g = {}    for i in range(len(names)):        g['Ten thuoc'] = names[i]        g['Hinh Anh'] = images[i]        g['Thanh Phan'] = info[i]        g['Phan loai'] = nhom[i]        save_todb(g)        print('Save')    returndef save_todb(d):    return collection.update(d, d, upsert=True)def get_all(url):    i = 1    while i < 282:        get_content(url)        i += 20        url = 'https://www.thuocbietduoc.com.vn/defaults/drgsearch?start=' + str(i)    return 'Finished'get_all(BASE_URL)